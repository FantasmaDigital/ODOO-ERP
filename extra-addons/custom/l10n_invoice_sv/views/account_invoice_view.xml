<odoo>
    <data>
        <record id="view_invoice_form_sv" model="ir.ui.view">
            <field name="name">Amount to Text</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                    <xpath expr="//field[@name='narration']" position="before">
                        <field class="oe_left" name="amount_text" placeholder="amount to text"/>
                    </xpath>
                    <xpath expr="//field[@name='journal_id']" position="before">
                        <field name="inv_refund_id" invisible="not inv_refund_id" readonly="True" />
                    </xpath>
                    <!-- En Odoo 19 state se gestiona con el widget statusbar -->
                    <xpath expr="//field[@name='payment_state']" position="before">
                        <field name="state_refund" invisible="state_refund != 'refund'" statusbar_visible="refund" widget="statusbar"/>
                    </xpath>
                    <!-- El botón de reversión en Odoo 19 -->
                    <xpath expr="//button[@name='action_reverse']" position="after">
                        <button name="%(account.action_view_account_move_reversal)d" type='action' string='Reversión SV' groups="account.group_account_invoice" invisible="move_type == 'out_refund' or state != 'posted' or state_refund == 'refund'"/>
                    </xpath>
            </field>
        </record>
        <record id="view_invoice_sv_tree" model="ir.ui.view">
            <field name="name">Amount to Text - List</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_invoice_tree"/>
            <field name="arch" type="xml">
                    <xpath expr="//list" position="inside">
                        <field name="state_refund" optional="show"/>
                    </xpath>
            </field>
        </record>
    </data>
</odoo>
